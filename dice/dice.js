const blockSize=5,epsilon=1e-10,spotSpacing=.25,spotRadius=.08,spotVertexCount=16,vertices=[[1,1,1],[1,-1,1],[1,-1,-1],[1,1,-1],[-1,1,-1],[-1,-1,-1],[-1,-1,1],[-1,1,1]],faces=[[1,[0,0,0]],[6,[Math.PI,0,0]],[2,[Math.PI/2,0,0]],[5,[-Math.PI/2,0,0]],[3,[0,-Math.PI/2,0]],[4,[0,Math.PI/2,0]]].map(t=>{const e=matrix_mul(rotationMatrix(t[1]),[1,0,0]);return[...t,e,vertices.filter(t=>inner_product(e,t)>epsilon)]}),spots=[[[0,0]],[[-1,-1],[1,1]],[[-1,-1],[0,0],[1,1]],[[-1,-1],[-1,1],[1,-1],[1,1]],[[-1,-1],[-1,1],[1,-1],[1,1],[0,0]],[[-1,-1],[-1,0],[-1,1],[1,-1],[1,0],[1,1]]].map(t=>t.map(t=>t.map(t=>t*spotSpacing+.5))).map(t=>t.map(a=>new Array(spotVertexCount).fill().map((t,e)=>[a[0]+spotRadius*Math.sin(e*Math.PI*2/spotVertexCount),a[1]+spotRadius*Math.cos(e*Math.PI*2/spotVertexCount)])));function init(){document.querySelectorAll("button,canvas").forEach(t=>t.addEventListener("click",execute)),document.querySelectorAll('input[type="tel"]').forEach(t=>t.addEventListener("change",execute))}function rotationMatrix(t){return[[Math.cos(t[0])*Math.cos(t[1]),Math.cos(t[0])*Math.sin(t[1])*Math.sin(t[2])-Math.sin(t[0])*Math.cos(t[2]),Math.cos(t[0])*Math.sin(t[1])*Math.cos(t[2])+Math.sin(t[0])*Math.sin(t[2])],[Math.sin(t[0])*Math.cos(t[1]),Math.sin(t[0])*Math.sin(t[1])*Math.sin(t[2])+Math.cos(t[0])*Math.cos(t[2]),Math.sin(t[0])*Math.sin(t[1])*Math.cos(t[2])-Math.cos(t[0])*Math.sin(t[2])],[-Math.sin(t[1]),Math.cos(t[1])*Math.sin(t[2]),Math.cos(t[1])*Math.cos(t[2])]]}function project(t,e){return[t[1],t[2]]}function rotate(t,e){return matrix_mul(t,rotationMatrix(e))}function inner_product(e,a){let o=0;for(let t=0;t<e.length;t++)o+=e[t]*a[t];return o}function matrix_mul(a,o){return o.map((t,e)=>a[e].map((t,e)=>t*o[e]).reduce((t,e)=>t+e,0))}let timeout;function draw(t,e){timeout&&clearTimeout(timeout);var a=document.getElementById("canvas");const o=a.getContext("2d"),n=(o.clearRect(0,0,a.width,a.height),rotationMatrix(t));cameraDirection=[-1,0,0];var i=faces.map((t,e)=>[t[0],matrix_mul(n,t[2]),t[3]]).filter(t=>inner_product(cameraDirection,t[1])<-epsilon).map(t=>[t[0],t[1],t[2].map(t=>matrix_mul(n,t))]);const r=Math.min(a.height,a.width)/2,c=r/2;i.forEach(t=>{const n=t[2].map(t=>project(t,cameraDirection).map(t=>t*c+r));o.beginPath(),o.moveTo(...n[0]),n.slice(1).forEach(t=>o.lineTo(...t)),o.closePath(),o.stroke(),o.fillStyle="#c00",o.fill();t=spots[t[0]-1];if(t&&0<t.length){const i=[n[1],n[3]].map(t=>t.map((t,e)=>t-n[0][e]));t.forEach(t=>{o.beginPath();t=t.map(a=>{var o=[...n[0]];for(let e=0;e<2;e++)for(let t=0;t<2;t++)o[e]+=a[t]*i[t][e];return o});o.beginPath(),o.moveTo(...t[0]),t.slice(1).forEach(t=>o.lineTo(...t)),o.closePath(),o.fillStyle="white",o.fill()})}}),e?0<e.length&&(timeout=setTimeout(()=>draw(e.shift(),e),30)):timeout=setTimeout(()=>draw([t[0]+.06,t[1],t[2]]),30)}function execute(){var t=parseInt(document.getElementById("count").value)||1;const e=parseInt(document.getElementById("sides").value)||6,a=new Array(t).fill().map(()=>Math.floor(Math.random()*e+1));t=new Array(Math.ceil(t/blockSize)).fill().map((t,e)=>a.slice(e*blockSize,(e+1)*blockSize));const o=document.getElementById("results");if(o.replaceChildren(),t.forEach(t=>{const a=document.createElement("div");a.className="roll-group",t.forEach(t=>{var e=document.createElement("div");e.className="roll",e.append(t),a.appendChild(e)}),o.appendChild(a)}),6==e){const i=t[0][0];t=faces.find(t=>t[0]==i)[1].map(t=>-t);const r=new Array(3).fill().map(()=>Math.random()*Math.PI*2);var n=[t];let a=.01;Math.floor(40*Math.random());for(let t=0;t<50;t++)a*=1.05,n.unshift(n[0].map((t,e)=>t+r[e]*a));draw(n.shift(),n)}else draw(new Array(3).fill().map(()=>Math.random()*Math.PI*2))}init();
//# sourceMappingURL=dice.js.map